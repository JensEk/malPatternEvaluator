{
    "remoteAccessMFA": {
        "description": "Lacking Multi-Factor Authentication (MFA) on a remote access service may enable successful authentication by brute force attacks or login with compromised credentials.",
        "badPattern": [
            "MATCH (app:Application) WHERE app.name =~ '(?i).*VPN.*|.*RDP.*|.*Remote Access.*|.*Remote Service.*|.*Remote Desktop.*'",
            "WITH app",
            "MATCH (app)--(usr:Identity)--(cred:Credentials)",
            "WHERE NOT ANY(factor IN [(cred)<-[:requiredFactors]-(mfa:Credentials) | mfa.name] WHERE factor =~ '(?i).*MFA.*|.*2FA.*|.*Multi-Factor.*|.*Two-Factor.*')",
            "RETURN DISTINCT cred.name;"
        ], 
        "mitigation": [
            "MATCH (cred:Credentials) WHERE cred.name = '$?'",
            "WITH cred",
            "CREATE (cred2:Credentials {metaconcept: 'Credentials', name: 'MFA'}), (cred)-[:credentials]->(cred2), (cred2)-[:requiredFactors]->(cred)"
        ],
        "attackData": 
            {
                "Tactic": {
                    "Initial Access": ["T1133", "T1078"],
                    "Credential Access": ["T1110"]
                },
                "Mitigations": ["M1036", "M1032", "M1030", "M1017"]
            }
    },
    "unencryptedData": {
        "description": "Sensitive data (e.g., credentials, keys, tokens) stored in plaintext without encryption may be susceptible to unauthorized access and compromise.",
        "badPattern": [
            "MATCH (data:Data)-[:containedData]->(:Application)",
            "WHERE data.name =~ '(?i).*Secret.*|.*Sensitive.*|.*Key.*|.*Password.*|.*Credential.*|.*Token.*|.*Certificate.*|.*Ticket.*|.*Cookie.*' AND NOT (data)-[:encryptedData]->(:Credentials)",
            "RETURN DISTINCT data.name;"
        ],    
        "mitigation": [
            "MATCH (data:Data) WHERE data.name = '$?'",
            "WITH data",
            "CREATE (cred:Credentials {metaconcept: 'Credentials', name: 'EncryptionKey'}), (cred)<-[:encryptedData]-(data), (cred)-[:encryptCreds]->(data)"
        ],
        "attackData": 
            {
                "Tactic": {
                    "Credential Access": ["T1555", "T1003", "T1528", "T1649", "T1558", "T1539", "T1552"]
                },
                "Mitigations": ["M1047", "M1041", "M1027", "M1026", "M1022", "M1017", "M1032", "M1043", "M1040"]
            }
    },
    "unencryptedInfo": {
        "description": "Sensitive information (e.g., credentials, keys, tokens) stored in plaintext without encryption may be susceptible to unauthorized access and compromise.",
        "badPattern": [
            "MATCH (info:Information)<-[:containerData]-(data:Data)",
            "WHERE info.name =~ '(?i).*Secret.*|.*Sensitive.*|.*Key.*|.*Password.*|.*Credential.*|.*Token.*|.*Certificate.*|.*Ticket.*|.*Cookie.*' AND NOT (data)-[:encryptedData]->(:Credentials)",
            "RETURN DISTINCT data.name;"
        ],    
        "mitigation": [
            "MATCH (data:Data) WHERE data.name = '$?'",
            "WITH data",
            "CREATE (cred:Credentials {metaconcept: 'Credentials', name: 'EncryptionKey'}), (cred)<-[:encryptedData]-(data), (cred)-[:encryptCreds]->(data)"
        ],
        "attackData": 
            {
                "Tactic": {
                    "Credential Access": ["T1555", "T1003", "T1528", "T1649", "T1558", "T1539", "T1552"]
                },
                "Mitigations": ["M1047", "M1041", "M1027", "M1026", "M1022", "M1017", "M1032", "M1043", "M1040"]
            }
    },
    "excessivePrivAccounts": {
        "description": "Existence of service, guest or any other temporarily accounts with excessive permissions may facilitate initial access and lateral movement.",
        "badPattern": [
            "MATCH (acc:Identity)-[:highPrivAppIAMs]->(app:Application)",
            "WHERE acc.name =~ '(?i).*Service.*|.*Support.*|.*Test.*|.*Temporarily.*|.*Default.*|.*Guest.*'",
            "RETURN DISTINCT acc.name, app.name;"
        ],    
        "mitigation": [
            "MATCH (acc:Identity)-[r1:highPrivAppIAMs]->(app:Application),(acc:Identity)<-[r2:highPrivApps]-(app:Application)",
            "WHERE acc.name = '$?' AND app.name = '$?'",
            "DELETE r1,r2",
            "CREATE (acc)-[:lowPrivAppIAMs]->(app), (acc)<-[:lowPrivApps]-(app)"
        ],
        "attackData": 
            {
                "Tactic": {
                    "Initial Access": ["T1199", "T1078"],
                    "Privilege Escalation": ["1078"]
                    
                },
                "Mitigations": ["M1032", "M1018", "M1026", "M1036"]
            }
    }
}